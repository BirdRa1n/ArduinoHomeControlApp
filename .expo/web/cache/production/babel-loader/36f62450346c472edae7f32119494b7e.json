{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"trigger\",\"closeOnSelect\",\"children\",\"onOpen\",\"onClose\",\"isOpen\",\"defaultIsOpen\",\"placement\"],_excluded2=[\"transition\"],_excluded3=[\"menuRef\",\"children\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import React,{memo,forwardRef}from'react';import Box from\"../../primitives/Box\";import{usePropsResolution}from\"../../../hooks/useThemeProps\";import{Popper}from\"../Popper\";import AccessibilityInfo from\"react-native-web/dist/exports/AccessibilityInfo\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import{useControllableState}from\"../../../hooks\";import{useMenuTrigger,useMenu,useMenuTypeahead}from\"./useMenu\";import Backdrop from\"../Backdrop\";import{PresenceTransition}from\"../Transitions\";import{FocusScope}from'@react-native-aria/focus';import{MenuContext}from\"./MenuContext\";import{Overlay}from\"../../primitives/Overlay\";import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";var Menu=function Menu(_ref,ref){var trigger=_ref.trigger,_ref$closeOnSelect=_ref.closeOnSelect,closeOnSelect=_ref$closeOnSelect===void 0?true:_ref$closeOnSelect,children=_ref.children,onOpen=_ref.onOpen,onClose=_ref.onClose,isOpenProp=_ref.isOpen,defaultIsOpen=_ref.defaultIsOpen,_ref$placement=_ref.placement,placement=_ref$placement===void 0?'bottom left':_ref$placement,props=_objectWithoutProperties(_ref,_excluded);var triggerRef=React.useRef(null);var _useControllableState=useControllableState({value:isOpenProp,defaultValue:defaultIsOpen,onChange:function onChange(value){value?onOpen&&onOpen():onClose&&onClose();}}),_useControllableState2=_slicedToArray(_useControllableState,2),isOpen=_useControllableState2[0],setIsOpen=_useControllableState2[1];var _usePropsResolution=usePropsResolution('Menu',props),transition=_usePropsResolution.transition,resolvedProps=_objectWithoutProperties(_usePropsResolution,_excluded2);var handleOpen=React.useCallback(function(){setIsOpen(true);},[setIsOpen]);var handleClose=React.useCallback(function(){setIsOpen(false);},[setIsOpen]);var triggerProps=useMenuTrigger({handleOpen:handleOpen,isOpen:isOpen});var updatedTrigger=function updatedTrigger(){return trigger(_objectSpread(_objectSpread({},triggerProps),{},{ref:triggerRef,onPress:handleOpen}),{open:isOpen});};React.useEffect(function(){if(isOpen){AccessibilityInfo.announceForAccessibility('Popup window');}},[isOpen]);if(useHasResponsiveProps(resolvedProps)){return null;}return React.createElement(React.Fragment,null,updatedTrigger(),React.createElement(Overlay,{isOpen:isOpen,onRequestClose:handleClose,useRNModalOnAndroid:true},React.createElement(PresenceTransition,_extends({visible:isOpen},transition),React.createElement(Popper,_extends({triggerRef:triggerRef,onClose:handleClose,placement:placement},props),React.createElement(Backdrop,{bg:\"transparent\",onPress:handleClose}),React.createElement(Popper.Content,null,React.createElement(MenuContext.Provider,{value:{closeOnSelect:closeOnSelect,onClose:handleClose}},React.createElement(FocusScope,{contain:true,restoreFocus:true,autoFocus:true},React.createElement(MenuContent,_extends({menuRef:ref},resolvedProps),children))))))));};var MenuContent=function MenuContent(_ref2){var menuRef=_ref2.menuRef,children=_ref2.children,props=_objectWithoutProperties(_ref2,_excluded3);var menuProps=useMenu();var typeaheadProps=useMenuTypeahead(menuProps);return React.createElement(Box,_extends({},props,menuProps,typeaheadProps,{ref:menuRef}),React.createElement(ScrollView,null,children));};export default memo(forwardRef(Menu));","map":{"version":3,"sources":["Menu.tsx"],"names":["Menu","closeOnSelect","isOpen","placement","props","triggerRef","React","useControllableState","value","defaultValue","onChange","onOpen","onClose","resolvedProps","usePropsResolution","handleOpen","setIsOpen","handleClose","triggerProps","useMenuTrigger","updatedTrigger","trigger","ref","onPress","open","AccessibilityInfo","useHasResponsiveProps","MenuContent","menuProps","useMenu","typeaheadProps","useMenuTypeahead","menuRef","memo","forwardRef"],"mappings":"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","sourcesContent":["import React, { memo, forwardRef } from 'react';\nimport type { IMenuProps } from './types';\nimport Box from '../../primitives/Box';\nimport { usePropsResolution } from '../../../hooks/useThemeProps';\nimport { Popper } from '../Popper';\nimport { AccessibilityInfo, ScrollView } from 'react-native';\nimport { useControllableState } from '../../../hooks';\nimport { useMenuTrigger, useMenu, useMenuTypeahead } from './useMenu';\nimport Backdrop from '../Backdrop';\nimport { PresenceTransition } from '../Transitions';\nimport { FocusScope } from '@react-native-aria/focus';\nimport { MenuContext } from './MenuContext';\nimport { Overlay } from '../../primitives/Overlay';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst Menu = (\n  {\n    trigger,\n    closeOnSelect = true,\n    children,\n    onOpen,\n    onClose,\n    isOpen: isOpenProp,\n    defaultIsOpen,\n    placement = 'bottom left',\n    ...props\n  }: IMenuProps,\n  ref?: any\n) => {\n  const triggerRef = React.useRef(null);\n  const [isOpen, setIsOpen] = useControllableState({\n    value: isOpenProp,\n    defaultValue: defaultIsOpen,\n    onChange: (value) => {\n      value ? onOpen && onOpen() : onClose && onClose();\n    },\n  });\n\n  const { transition, ...resolvedProps } = usePropsResolution('Menu', props);\n  const handleOpen = React.useCallback(() => {\n    setIsOpen(true);\n  }, [setIsOpen]);\n\n  const handleClose = React.useCallback(() => {\n    setIsOpen(false);\n  }, [setIsOpen]);\n\n  const triggerProps = useMenuTrigger({\n    handleOpen,\n    isOpen,\n  });\n\n  const updatedTrigger = () => {\n    return trigger(\n      {\n        ...triggerProps,\n        ref: triggerRef,\n        onPress: handleOpen,\n      },\n      { open: isOpen }\n    );\n  };\n\n  React.useEffect(() => {\n    if (isOpen) {\n      AccessibilityInfo.announceForAccessibility('Popup window');\n    }\n  }, [isOpen]);\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(resolvedProps)) {\n    return null;\n  }\n  return (\n    <>\n      {updatedTrigger()}\n      <Overlay isOpen={isOpen} onRequestClose={handleClose} useRNModalOnAndroid>\n        <PresenceTransition visible={isOpen} {...transition}>\n          <Popper\n            triggerRef={triggerRef}\n            onClose={handleClose}\n            placement={placement}\n            {...props}\n          >\n            <Backdrop bg=\"transparent\" onPress={handleClose} />\n            <Popper.Content>\n              <MenuContext.Provider\n                value={{ closeOnSelect, onClose: handleClose }}\n              >\n                <FocusScope contain restoreFocus autoFocus>\n                  <MenuContent menuRef={ref} {...resolvedProps}>\n                    {children}\n                  </MenuContent>\n                </FocusScope>\n              </MenuContext.Provider>\n            </Popper.Content>\n          </Popper>\n        </PresenceTransition>\n      </Overlay>\n    </>\n  );\n};\n\nconst MenuContent = ({\n  menuRef,\n  children,\n  ...props\n}: Omit<IMenuProps, 'trigger'> & { menuRef: any }) => {\n  const menuProps = useMenu();\n  const typeaheadProps = useMenuTypeahead(menuProps);\n\n  return (\n    <Box {...props} {...menuProps} {...typeaheadProps} ref={menuRef}>\n      <ScrollView>{children}</ScrollView>\n    </Box>\n  );\n};\n\nexport default memo(forwardRef(Menu));\n"]},"metadata":{},"sourceType":"module"}